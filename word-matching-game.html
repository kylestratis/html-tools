<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Word Matching Game - HTML Tools</title>
    <link rel="stylesheet" href="theme.css">
    <style>
        :root {
            --bg-gradient-start: #667eea;
            --bg-gradient-end: #764ba2;
            --container-bg: #ffffff;
            --game-area-bg: #f8f9fa;
            --canvas-bg: #ffffff;
            --canvas-text: #333;
            --canvas-circle: #667eea;
            --canvas-highlight: #fff3cd;
            --button-gradient-start: #667eea;
            --button-gradient-end: #764ba2;
        }

        body.dark-mode {
            --bg-gradient-start: #1a1a2e;
            --bg-gradient-end: #16213e;
            --container-bg: #2d2d2d;
            --game-area-bg: #1a1a1a;
            --canvas-bg: #3a3a3a;
            --canvas-text: #e0e0e0;
            --canvas-circle: #8b9eff;
            --canvas-highlight: #4a4a2a;
            --button-gradient-start: #4a5fa8;
            --button-gradient-end: #6d4a8a;
        }

        body {
            background: linear-gradient(135deg, var(--bg-gradient-start) 0%, var(--bg-gradient-end) 100%);
            min-height: 100vh;
            display: flex;
            align-items: center;
            justify-content: center;
            padding: 20px;
            transition: background 0.3s ease;
        }

        .container {
            background: var(--container-bg);
            border-radius: 20px;
            padding: 40px;
            box-shadow: 0 20px 60px var(--shadow);
            max-width: 800px;
            width: 100%;
            transition: background-color 0.3s ease;
        }

        h1 {
            color: var(--accent-primary);
            margin-bottom: 10px;
            text-align: center;
        }

        .instructions {
            text-align: center;
            color: var(--text-secondary);
            margin-bottom: 30px;
            font-size: 16px;
            line-height: 1.6;
        }

        .game-area {
            background: var(--game-area-bg);
            border-radius: 10px;
            padding: 20px;
            margin-bottom: 20px;
            transition: background-color 0.3s ease;
        }

        canvas {
            display: block;
            margin: 0 auto;
            background: var(--canvas-bg);
            border-radius: 10px;
            cursor: pointer;
            max-width: 100%;
            height: auto;
            transition: background-color 0.3s ease;
        }

        .controls {
            display: flex;
            gap: 10px;
            justify-content: center;
            flex-wrap: wrap;
        }

        button {
            background: linear-gradient(135deg, var(--button-gradient-start) 0%, var(--button-gradient-end) 100%);
            color: white;
            border: none;
            padding: 12px 30px;
            border-radius: 25px;
            font-size: 16px;
            font-weight: 600;
            cursor: pointer;
            transition: transform 0.2s, box-shadow 0.2s, background 0.3s ease;
        }

        button:hover {
            transform: translateY(-2px);
            box-shadow: 0 5px 15px rgba(102, 126, 234, 0.4);
        }

        button:active {
            transform: translateY(0);
        }

        button:disabled {
            background: #ccc;
            cursor: not-allowed;
            transform: none;
        }

        .theme-toggle {
            position: fixed;
            top: 20px;
            right: 20px;
            background: var(--toggle-bg);
            border: 2px solid var(--toggle-border);
            border-radius: 50px;
            padding: 10px 20px;
            cursor: pointer;
            font-size: 20px;
            box-shadow: 0 2px 10px rgba(0, 0, 0, 0.2);
            transition: all 0.3s ease;
            z-index: 1000;
        }

        .theme-toggle:hover {
            transform: scale(1.05);
            box-shadow: 0 4px 15px rgba(0, 0, 0, 0.3);
        }

        .theme-toggle:active {
            transform: scale(0.95);
        }

        .message {
            text-align: center;
            margin-top: 20px;
            font-size: 18px;
            font-weight: 600;
            min-height: 30px;
        }

        .message.correct {
            color: #28a745;
        }

        .message.incorrect {
            color: #dc3545;
        }

        .message.info {
            color: #667eea;
        }

        .footer {
            margin-top: 30px;
            text-align: center;
            color: var(--text-secondary);
            font-size: 14px;
        }

        .footer a {
            color: var(--accent-primary);
            text-decoration: none;
        }

        .footer a:hover {
            text-decoration: underline;
        }

        @media (max-width: 600px) {
            .container {
                padding: 20px;
            }

            h1 {
                font-size: 24px;
            }

            .instructions {
                font-size: 14px;
            }

            button {
                padding: 10px 20px;
                font-size: 14px;
            }
        }
    </style>
</head>
<body>
    <button class="theme-toggle" id="themeToggle" aria-label="Toggle dark mode">
        <span class="theme-icon">üåô</span>
    </button>

    <div class="container">
        <h1>üéØ Word Matching Game</h1>
        <p class="instructions">
            Find the word that matches the circled word! Click on the matching word and press Submit to check your answer.
        </p>

        <div class="game-area">
            <canvas id="gameCanvas" width="700" height="400"></canvas>
        </div>

        <div class="controls">
            <button id="refreshBtn">üîÑ New Game</button>
            <button id="submitBtn" disabled>‚úì Submit Answer</button>
        </div>

        <div id="message" class="message"></div>

        <div class="footer">
            <a href="index.html">‚Üê Back to HTML Tools</a>
        </div>
    </div>

    <script>
        // Word pool (3-4 letter words)
        const wordPool = [
            'cat', 'dog', 'hat', 'bat', 'rat', 'mat', 'sat', 'pat',
            'car', 'bar', 'far', 'jar', 'tar', 'war', 'run', 'sun',
            'fun', 'bun', 'gun', 'cut', 'but', 'put', 'nut', 'hut',
            'red', 'bed', 'led', 'fed', 'wed', 'pen', 'hen', 'ten',
            'men', 'den', 'fox', 'box', 'mix', 'fix', 'six', 'wax',
            'tree', 'free', 'flee', 'knee', 'moon', 'soon', 'noon', 'boon',
            'star', 'scar', 'char', 'grab', 'crab', 'flag', 'drag', 'snag',
            'ship', 'chip', 'trip', 'drip', 'flip', 'slip', 'clip', 'skip',
            'blue', 'glue', 'clue', 'true', 'frog', 'blog', 'clog', 'smog',
            'rain', 'pain', 'main', 'gain', 'snow', 'slow', 'glow', 'flow'
        ];

        const canvas = document.getElementById('gameCanvas');
        const ctx = canvas.getContext('2d');
        const refreshBtn = document.getElementById('refreshBtn');
        const submitBtn = document.getElementById('submitBtn');
        const messageEl = document.getElementById('message');

        let words = [];
        let wordPositions = [];
        let circledIndex = -1;
        let matchingIndex = -1;
        let selectedIndex = -1;

        // Initialize game
        function initGame() {
            // Select 4 unique words + 1 duplicate
            const uniqueWords = [];
            while (uniqueWords.length < 4) {
                const word = wordPool[Math.floor(Math.random() * wordPool.length)];
                if (!uniqueWords.includes(word)) {
                    uniqueWords.push(word);
                }
            }

            // Pick one word to duplicate
            const duplicateWord = uniqueWords[Math.floor(Math.random() * uniqueWords.length)];

            // Create array of 5 words (4 unique + 1 duplicate)
            words = [...uniqueWords, duplicateWord];

            // Shuffle the words
            for (let i = words.length - 1; i > 0; i--) {
                const j = Math.floor(Math.random() * (i + 1));
                [words[i], words[j]] = [words[j], words[i]];
            }

            // Find the indices of the duplicate word
            const duplicateIndices = [];
            words.forEach((word, index) => {
                if (word === duplicateWord) {
                    duplicateIndices.push(index);
                }
            });

            // One will be circled, the other is the answer
            circledIndex = duplicateIndices[0];
            matchingIndex = duplicateIndices[1];

            // Generate random positions for words
            wordPositions = [];
            const margin = 80;
            const canvasWidth = canvas.width;
            const canvasHeight = canvas.height;

            for (let i = 0; i < words.length; i++) {
                let x, y, tooClose;
                let attempts = 0;

                do {
                    tooClose = false;
                    x = margin + Math.random() * (canvasWidth - margin * 2);
                    y = margin + Math.random() * (canvasHeight - margin * 2);

                    // Check distance from other words
                    for (let pos of wordPositions) {
                        const dist = Math.sqrt((x - pos.x) ** 2 + (y - pos.y) ** 2);
                        if (dist < 100) {
                            tooClose = true;
                            break;
                        }
                    }

                    attempts++;
                    if (attempts > 50) break; // Prevent infinite loop
                } while (tooClose);

                wordPositions.push({ x, y });
            }

            selectedIndex = -1;
            submitBtn.disabled = true;
            messageEl.textContent = '';
            messageEl.className = 'message';

            drawGame();
        }

        function drawGame() {
            // Get current theme colors
            const isDarkMode = document.body.classList.contains('dark-mode');
            const canvasBg = getComputedStyle(document.documentElement).getPropertyValue('--canvas-bg').trim();
            const canvasText = getComputedStyle(document.documentElement).getPropertyValue('--canvas-text').trim();
            const canvasCircle = getComputedStyle(document.documentElement).getPropertyValue('--canvas-circle').trim();
            const canvasHighlight = getComputedStyle(document.documentElement).getPropertyValue('--canvas-highlight').trim();

            // Clear with background color
            ctx.fillStyle = canvasBg;
            ctx.fillRect(0, 0, canvas.width, canvas.height);

            // Draw words
            ctx.font = 'bold 32px Arial';
            ctx.textAlign = 'center';
            ctx.textBaseline = 'middle';

            words.forEach((word, index) => {
                const pos = wordPositions[index];

                // Draw circle around the target word
                if (index === circledIndex) {
                    ctx.strokeStyle = canvasCircle;
                    ctx.lineWidth = 4;
                    ctx.beginPath();
                    ctx.arc(pos.x, pos.y, 45, 0, 2 * Math.PI);
                    ctx.stroke();
                }

                // Highlight selected word
                if (index === selectedIndex) {
                    ctx.fillStyle = canvasHighlight;
                    ctx.beginPath();
                    ctx.arc(pos.x, pos.y, 40, 0, 2 * Math.PI);
                    ctx.fill();
                }

                // Draw word
                ctx.fillStyle = canvasText;
                ctx.fillText(word, pos.x, pos.y);
            });
        }

        function handleCanvasClick(event) {
            const rect = canvas.getBoundingClientRect();
            const scaleX = canvas.width / rect.width;
            const scaleY = canvas.height / rect.height;
            const x = (event.clientX - rect.left) * scaleX;
            const y = (event.clientY - rect.top) * scaleY;

            // Check if click is near any word
            selectedIndex = -1;
            for (let i = 0; i < wordPositions.length; i++) {
                const pos = wordPositions[i];
                const dist = Math.sqrt((x - pos.x) ** 2 + (y - pos.y) ** 2);

                if (dist < 45) {
                    // Don't allow selecting the circled word
                    if (i !== circledIndex) {
                        selectedIndex = i;
                        submitBtn.disabled = false;
                        messageEl.textContent = '';
                        messageEl.className = 'message';
                    } else {
                        messageEl.textContent = 'You can\'t select the circled word!';
                        messageEl.className = 'message info';
                    }
                    break;
                }
            }

            if (selectedIndex === -1) {
                submitBtn.disabled = true;
            }

            drawGame();
        }

        function checkAnswer() {
            if (selectedIndex === -1) return;

            if (selectedIndex === matchingIndex) {
                messageEl.textContent = 'üéâ Correct! You found the matching word!';
                messageEl.className = 'message correct';
                submitBtn.disabled = true;
            } else {
                messageEl.textContent = `‚ùå Incorrect. Try again! (Selected: "${words[selectedIndex]}", Target: "${words[circledIndex]}")`;
                messageEl.className = 'message incorrect';
                selectedIndex = -1;
                submitBtn.disabled = true;
                drawGame();
            }
        }

        // Event listeners
        refreshBtn.addEventListener('click', initGame);
        submitBtn.addEventListener('click', checkAnswer);
        canvas.addEventListener('click', handleCanvasClick);

        // Handle canvas responsiveness
        function resizeCanvas() {
            const container = canvas.parentElement;
            const maxWidth = container.clientWidth - 40;
            if (maxWidth < 700) {
                canvas.style.width = maxWidth + 'px';
                canvas.style.height = (maxWidth * 400 / 700) + 'px';
            } else {
                canvas.style.width = '700px';
                canvas.style.height = '400px';
            }
        }

        window.addEventListener('resize', resizeCanvas);
        resizeCanvas();

        // Start first game
        initGame();

        // Register canvas redraw callback for theme changes
        window.onThemeChange = function() {
            drawGame();
        };
    </script>
    <script src="theme.js"></script>
</body>
</html>
